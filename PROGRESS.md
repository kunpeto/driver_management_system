# 開發進度追蹤

**最後更新**: 2026-01-28 20:15

---

## 整體進度

| Phase | 名稱 | 任務數 | 完成數 | 進度 | 狀態 |
|-------|------|--------|--------|------|------|
| 0 | Setup | 11 | 11 | 100% | ✅ 完成 |
| 2 | Foundational | 24 | 0 | 0% | 🔄 下一步 |
| 3 | US1 - 系統設定 | 10 | 0 | 0% | ⏳ 待開始 |
| 4 | US2 - 員工管理 | 16 | 0 | 0% | ⏳ 待開始 |
| 5 | US3 - 權限控制 | 8 | 0 | 0% | ⏳ 待開始 |
| 6 | US4 - 班表同步 | 12 | 0 | 0% | ⏳ 待開始 |
| 7 | US6 - 連線監控 | 8 | 0 | 0% | ⏳ 待開始 |
| 8 | US7 - PDF 處理 | 15 | 0 | 0% | ⏳ 待開始 |
| 9 | US5 - 駕駛競賽 | 16 | 0 | 0% | ⏳ 待開始 |
| 10 | Polish | 12 | 0 | 0% | ⏳ 待開始 |

**總計**: 131 個任務，已完成 16 個（12.2%）

---

## Phase 0: Setup ✅ 完成

**完成日期**: 2026-01-28

### 已完成任務

- [x] T001 建立專案根目錄結構
- [x] T002 建立 backend 資料夾結構
- [x] T003 建立 frontend 資料夾結構（Vue.js 專案初始化）
- [x] T004 建立 desktop_app 資料夾結構
- [x] T005 建立 .gitignore（含憑證保護規則）
- [x] T006 建立 .env.example（環境變數範本）
- [x] T007 建立 requirements.txt（Python 依賴）
- [x] T008 建立 package.json（前端依賴）
- [x] T009 Git 初始化
- [x] T010 建立 README.md
- [x] T011 建立規格文件結構

### 額外完成項目

- [x] 建立 render.yaml（Render Blueprint 配置）
- [x] TiDB 連線測試成功
- [x] 淡海 Google Sheets 存取測試成功
- [x] FastAPI 主程式建立
- [x] 環境變數配置（settings.py）
- [x] 資料庫連線配置（database.py）
- [x] SQLAlchemy Base 模型（base.py）

---

## Phase 2: Foundational 🔄 進行中

**開始日期**: 2026-01-28
**預計完成**: 2026-01-29

### 已完成任務

#### 資料庫與連線
- [x] T012 建立 TiDB 連線配置 ✅ 2026-01-28
- [x] T013 建立環境變數載入工具 ✅ 2026-01-28
- [x] T014 建立資料庫 Base 模型 ✅ 2026-01-28

#### API 基礎設施
- [x] T023 建立 FastAPI 主程式 ✅ 2026-01-28
- [x] T026 建立健康檢查端點 ✅ 2026-01-28

### 待完成任務

#### 資料庫與連線
- [ ] T015 建立資料庫初始化腳本

#### 憑證管理系統
- [ ] T016 實作 TokenEncryption 類別（Fernet 加密）
- [ ] T017 實作服務帳戶憑證載入工具
- [ ] T018 實作本機憑證管理器
- [ ] T037a 實作憑證驗證服務
- [ ] T037b 實作憑證驗證整合測試

#### 認證與授權
- [ ] T019 建立 JWT 工具類別
- [ ] T020 實作密碼雜湊工具（bcrypt）
- [ ] T021 實作認證中間件
- [ ] T022 實作權限檢查中間件

#### API 基礎設施
- [ ] T023 建立 FastAPI 主程式（已完成）
- [ ] T024 建立錯誤處理中間件
- [ ] T025 建立日誌配置
- [ ] T026 建立健康檢查端點（已部分完成）

#### 前端基礎設施
- [ ] T027 設定 Vue Router
- [ ] T028 設定 Pinia Store
- [ ] T029 設定 Axios 實例
- [ ] T030 建立全域錯誤處理器
- [ ] T031 建立 UI 元件庫封裝

#### 本機 API 基礎設施
- [ ] T032 建立本機 FastAPI 主程式
- [ ] T033 建立系統托盤程式

---

## 里程碑

| 里程碑 | 預計日期 | 狀態 | 說明 |
|--------|---------|------|------|
| M1: 基礎架構完成 | 2026-01-28 | ✅ | Phase 0 完成 |
| M2: 核心功能可用 | TBD | ⏳ | Phase 2-5 完成（MVP） |
| M3: 功能完整 | TBD | ⏳ | Phase 6-9 完成 |
| M4: 系統上線 | TBD | ⏳ | Phase 10 完成 |

---

## 時間線

### 2026-01-28

**上午**
- 規格文件審查與分析（Gemini 協作）
- 修正 Constitution v1.2.0（憑證管理策略）
- 修正 spec.md FR-020（OAuth 授權描述）

**下午**
- 釐清駕駛競賽計算公式（PC-001）
- 新增 RouteStandardTime 資料模型
- 新增 FR-031~033（勤務標準時間管理）
- 更新 User Story 5 驗收情境

**晚上**
- 設定開發環境（虛擬環境、依賴套件）
- 測試 TiDB 連線
- 測試淡海 Google Sheets 存取
- 建立專案基礎架構
- 調整架構以支援 Render 部署
- Git commit 並 push

---

## 已釐清事項

### PC-001: 駕駛競賽計算公式 ✅

**公式**:
```
最終積分 = Σ(每日勤務時數 × R班係數) × 責任事件懲罰係數

- R班係數: 休息日出勤 × 2，一般出勤 × 1
- 責任事件懲罰係數: × 1/(1+N)，N = 當月責任事件數
```

**排名規則**:
- 積分最高者為第一名
- 無最低出勤天數門檻
- 離職人員不納入排名

---

## 下次開發重點

1. **Phase 2 優先任務**
   - T016: TokenEncryption（Fernet 加密）
   - T019-T022: 認證與授權系統
   - T015: 資料庫初始化腳本

2. **資料模型建立**
   - User 模型
   - Employee 模型
   - SystemSetting 模型

3. **測試驗證**
   - 認證流程測試
   - 權限控制測試
