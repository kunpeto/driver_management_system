"""
差勤相關常量定義
對應 Gemini Review 建議：提取正則表達式配置

將硬編碼的模式提取到此配置檔，方便統一管理。
"""

# ============================================================
# 請假標記模式
# ============================================================

# 請假標記（含全形變體）
# 用於全勤判定：包含任一標記即視為請假
LEAVE_PATTERNS = [
    r"\(假\)", r"（假）",       # 例假
    r"\(特\)", r"（特）",       # 特休
    r"\(公\)", r"（公）",       # 公假
    r"\(婚\)", r"（婚）",       # 婚假
    r"\(喪\)", r"（喪）",       # 喪假
    r"\(病\)", r"（病）",       # 病假
    r"\(事\)", r"（事）",       # 事假
    r"\(育\)", r"（育）",       # 育嬰假
    r"\(產\)", r"（產）",       # 產假
    r"\(傷\)", r"（傷）",       # 傷病假
    r"\(陪\)", r"（陪）",       # 陪產假
    r"\(生\)", r"（生）",       # 生理假
]

# ============================================================
# R班模式
# ============================================================

# R班標記模式（正則表達式）
# 匹配：R/0905G, R(國)/1425G, R(國)/0905G(+2) 等
R_SHIFT_PATTERN = r"^R(?:\((國|国)\))?/(.+)$"

# 國定假日 R班標記模式
# 匹配：R(國)/... 或 R(国)/...
NATIONAL_HOLIDAY_PATTERN = r"^R\((國|国)\)/"

# ============================================================
# 延長工時模式
# ============================================================

# 延長工時標記模式
# 匹配：(+1), (+2), (+3), (+4) 及全形變體
OVERTIME_PATTERN = r"[（\(]\+([1-4])[）\)]"

# 延長工時考核代碼對照表
OVERTIME_CODE_MAP = {
    1: "+A03",
    2: "+A04",
    3: "+A05",
    4: "+A06"
}

# 延長工時分數對照表
OVERTIME_POINTS_MAP = {
    1: 0.5,
    2: 1.0,
    3: 1.5,
    4: 2.0
}

# ============================================================
# 加分項目分數
# ============================================================

# +A 系列分數對照表
A_SERIES_POINTS = {
    "+A01": 3.0,   # R班出勤
    "+A02": 1.0,   # 國定假日出勤
    "+A03": 0.5,   # 延長工時 1 小時
    "+A04": 1.0,   # 延長工時 2 小時
    "+A05": 1.5,   # 延長工時 3 小時
    "+A06": 2.0,   # 延長工時 4 小時
}

# +M 系列分數對照表
M_SERIES_POINTS = {
    "+M01": 3.0,   # 月度全勤
    "+M02": 1.0,   # 月度行車零違規
    "+M03": 2.0,   # 月度全項目零違規
}

# ============================================================
# 班表表頭欄位別名
# ============================================================

# 員工編號欄位可能的名稱
EMPLOYEE_ID_COLUMN_ALIASES = [
    "編號", "員編", "員工編號", "員工ID", "工號", "ID"
]

# 員工姓名欄位可能的名稱
EMPLOYEE_NAME_COLUMN_ALIASES = [
    "姓名", "員工姓名", "名字", "Name"
]
